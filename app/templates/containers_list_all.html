<!DOCTYPE html>
<html class="h-full">
<head>
  <meta charset="UTF-8" />
  <title>All Containers</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex flex-col min-h-screen bg-gradient-to-br from-gray-100 via-gray-200 to-white text-gray-900">
  {% include "partials/navbar.html" %}

  <div class="flex-grow px-6 py-10 w-full">

    <div class="flex space-x-4 mb-6">
      <a href="/containers"
        class="px-4 py-2 rounded font-semibold shadow
                {% if request.url.path == '/containers' %}bg-blue-600 text-white{% else %}bg-white text-gray-800 border border-gray-300{% endif %}">
        ğŸš€ Standalone Containers
      </a>
      <a href="/containers/compose-groups"
        class="px-4 py-2 rounded font-semibold shadow
                {% if request.url.path == '/containers/compose-groups' %}bg-purple-600 text-white{% else %}bg-white text-gray-800 border border-gray-300{% endif %}">
        ğŸ“¦ Docker Compose Groups
      </a>
      <a href="/containers/list-all"
        class="px-4 py-2 rounded font-semibold shadow
                {% if request.url.path == '/containers/list-all' %}bg-purple-600 text-white{% else %}bg-white text-gray-800 border border-gray-300{% endif %}">
        ğŸ“ƒ List All Containers
      </a>
    </div>


    <h1 class="text-4xl font-extrabold mb-8 text-gray-800">ğŸ“ƒ All Docker Containers</h1>

    {% if request.query_params.get('success') %}
      <div class="mb-4 px-6 py-3 bg-green-100 text-green-800 border border-green-300 rounded-lg shadow-md">
        âœ… {{ request.query_params.get('success') }}
      </div>
    {% elif request.query_params.get('error') %}
      <div class="mb-4 px-6 py-3 bg-red-100 text-red-800 border border-red-300 rounded-lg shadow-md">
        âŒ {{ request.query_params.get('error') }}
      </div>
    {% endif %}

    {% if containers %}
    <div class="overflow-x-auto rounded-lg shadow border border-gray-300 bg-white">
      <table class="min-w-full divide-y divide-gray-300">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-6 py-3 text-left text-sm font-bold text-gray-700">#</th>
            <th class="px-6 py-3 text-left text-sm font-bold text-gray-700">Container Name</th>
            <th class="px-6 py-3 text-left text-sm font-bold text-gray-700">Image</th>
            <th class="px-6 py-3 text-left text-sm font-bold text-gray-700">Status</th>
            <th class="px-6 py-3 text-center text-sm font-bold text-gray-700">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200 bg-white text-sm">
          {% for c in containers %}
          <tr>
            <td class="px-6 py-4 text-gray-700">{{ loop.index }}</td>
            <td class="px-6 py-4 font-medium text-gray-900">{{ c.name }}</td>
            <td class="px-6 py-4 text-gray-700">{{ c.image }}</td>
            <td class="px-6 py-4">
              {% if 'running' in c.status %}
              <span class="inline-flex items-center px-2 py-0.5 text-sm font-medium bg-green-100 text-green-800 rounded-full">
                ğŸŸ¢ Running
              </span>
              {% else %}
              <span class="inline-flex items-center px-2 py-0.5 text-sm font-medium bg-red-100 text-red-800 rounded-full">
                ğŸ”´ Stopped
              </span>
              {% endif %}
            </td>
            <td class="px-6 py-4 text-center">
              <div class="flex justify-center space-x-2">
              {% if 'running' in c.status %}
              <form method="post" action="/containers/{{ c.id }}/stop">
                <button type="submit" class="px-4 py-2 text-sm hover:bg-yellow-100 rounded-md border border-gray-200">
                  â¸ Stop
                </button>
              </form>
              {% else %}
              <form method="post" action="/containers/{{ c.id }}/start">
                <button type="submit" class="px-4 py-2 text-sm hover:bg-yellow-100 rounded-md border border-gray-200">
                  â–¶ Start
                </button>
              </form>
              {% endif %}
              <form action="/containers/{{ c.id }}/logs" method="get">
                <button class="px-4 py-2 text-sm hover:bg-yellow-100 rounded-md border border-gray-200">
                  ğŸ“œ Logs
                </button>
              </form>

              <form action="/containers/{{ c.id }}/terminal" method="get">
                <button class="px-4 py-2 text-sm hover:bg-yellow-100 rounded-md border border-gray-200">
                  ğŸ–¥ï¸ Terminal
                </button>
              </form>
              <form method="post" action="/containers/{{ c.id }}/delete" onsubmit="return confirm('Are you sure you want to delete this container?')">
                <button type="submit" class="px-4 py-2 text-sm hover:bg-yellow-100 rounded-md border border-gray-200">
                  ğŸ—‘ Delete
                </button>
              </form>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
      <p class="text-center text-gray-500 text-lg mt-8">No containers found.</p>
    {% endif %}
  </div>

  <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-60 flex flex-col items-center justify-center z-50 hidden">
    <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-yellow-400 border-solid mb-6"></div>
    <span id="loading-message" class="text-white text-lg font-semibold animate-pulse">Just a sec... ğŸ˜Š</span>
  </div>

  <script>
    const loadingOverlay = document.getElementById("loading-overlay");
    const loadingMsg = document.getElementById("loading-message");
    const funnyMessages = [
      "Waking up the containers...",
      "Feeding the Docker daemon...",
      "Pushing bytes through the tubes...",
      "Assembling whales ğŸ³...",
      "Downloading the Internet (almost)...",
      "Negotiating with the GCR gods...",
      "Compiling caffeine...",
      "Whispering to Linux subsystems...",
      "Placing pixels just right...",
      "Summoning a smiley soon..."
    ];
    let intervalId;
    function startFunnyMessages() {
      intervalId = setInterval(() => {
        const randomMsg = funnyMessages[Math.floor(Math.random() * funnyMessages.length)];
        loadingMsg.textContent = randomMsg;
      }, 1600);
    }
    function showSmiley() {
      clearInterval(intervalId);
      loadingMsg.textContent = "Wait... ğŸ˜€";
    }
    document.querySelectorAll("form").forEach(form => {
      form.addEventListener("submit", () => {
        loadingOverlay.classList.remove("hidden");
        startFunnyMessages();
        setTimeout(showSmiley, 9000);
      });
    });
    window.addEventListener("pageshow", function (event) {
      const overlay = document.getElementById("loading-overlay");
      if (overlay) {
        overlay.classList.add("hidden");
      }
    });
  </script>
  {% include "partials/footer.html" %}
</body>
</html>